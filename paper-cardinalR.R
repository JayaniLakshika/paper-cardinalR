# Generated by `rjournal_pdf_article()` using `knitr::purl()`: do not edit by hand
# Please edit paper-cardinalR.Rmd to modify this file

## ----setup, include=FALSE-----------------------------------------------------
options(repos = "https://cloud.r-project.org") ## set up CRAN mirror
knitr::opts_chunk$set(
  echo = FALSE,
  cache=FALSE, 
  message=FALSE, 
  warning=FALSE,
  out.width = "100%",
  fig.pos = "!")



## ----set-seed-----------------------------------------------------------------
set.seed(20240412)


## ----install-libraries, include=FALSE, warning=FALSE, echo=FALSE--------------

options(repos = c(CRAN = "https://cran.rstudio.com")) # Setup mirror

packages_to_check <- c("remotes", "cardinalR", "tidyverse", "kableExtra", "geozoo", "patchwork", "colorspace")

for (pkg in packages_to_check) {
  if (!requireNamespace(pkg, quietly = TRUE)) {
    message(paste("Installing package:", pkg))
    install.packages(pkg)
  } else {
    installed_version <- packageVersion(pkg)
    available_version <- tryCatch({
      utils::packageDescription(pkg)$Version
    }, error = function(e) NA) # Handle cases where package info isn't readily available

    if (!is.na(available_version) && installed_version < package_version(available_version)) {
      message(paste("A newer version of package", pkg, "is available. Updating..."))
      install.packages(pkg)
    } else {
      message(paste("Package", pkg, "is up-to-date (version", installed_version, ")."))
    }
  }
}



## ----load-libraries-----------------------------------------------------------
library(cardinalR)
library(tidyverse)
library(kableExtra)
library(geozoo)
library(patchwork)
library(colorspace)
library(crosstalk)


## -----------------------------------------------------------------------------
#| label: plot-theme
theme_set(theme_linedraw() +
   theme(
     aspect.ratio = 1,
     plot.background = element_rect(fill = 'transparent', colour = NA),
     plot.title = element_text(size = 7, hjust = 0.5, vjust = -0.5),
     panel.background = element_rect(fill = 'transparent', 
                                     colour = NA),
     panel.grid.major = element_blank(), 
     panel.grid.minor = element_blank(), 
     axis.title.x = element_blank(), axis.title.y = element_blank(),
     axis.text.x = element_blank(), axis.ticks.x = element_blank(),
     axis.text.y = element_blank(), axis.ticks.y = element_blank(),
     legend.background = element_rect(fill = 'transparent', 
                                      colour = NA),
     legend.key = element_rect(fill = 'transparent', 
                               colour = NA),
     legend.position = "bottom", 
     legend.title = element_blank(), 
     legend.text = element_text(size=4),
     legend.key.height = unit(0.25, 'cm'),
     legend.key.width = unit(0.25, 'cm'),
     plot.margin = margin(0, 0, 0, 0)
   )
)


## -----------------------------------------------------------------------------
#| label: import-scripts
source("scripts/additional_functions.R")


## -----------------------------------------------------------------------------
main_tb <- tibble(arg = c("n",
                          "k",
                          "loc",
                          "scale",
                          "shape",
                          "rotation",
                          "is_bkg"),
                  type = c("numeric (vector)",
                           "numeric",
                           "numeric (matrix)",
                           "numeric (vector)",
                           "character (vector)",
                           "numeric (list)",
                           "boolean"),
                        exp = c("Number of points in each cluster.",
                                "Number of clusters.",
                                "Locations/centroids of clusters.",
                                "Scaling factors of clusters.",
                                "Shapes of clusters.",
                                "Rotation matrices, one per cluster.",
                                "Background noise should exist or not."))


## ----main-tb-html, eval=knitr::is_html_output()-------------------------------
# main_tb |>
#   kable(caption = "The main arguments for `gen_multicluster()`.", col.names = c("Argument", "Type", "Explanation"), linesep = "", table.pos = "H")


## ----main-tb-pdf, eval=knitr::is_latex_output()-------------------------------
main_tb |> 
  kable(caption = "The main arguments for gen\\_multicluster().", format="latex", col.names = c("Argument", "Type", "Explanation"), booktabs = T, table.pos = "H", linesep = "")  |>
  column_spec(1, width = "2cm") |>
  column_spec(2, width = "3cm") |>
  column_spec(3, width = "8cm")


## -----------------------------------------------------------------------------
branch_tb <- tibble(fun = c("gen_expbranches",
                             "gen_linearbranches",
                             "gen_curvybranches", 
                             "gen_orglinearbranches", 
                             "gen_orgcurvybranches"), 
                      exp = c("Exponential shaped branches.",
                               "Linear shaped branches.", 
                               "Curvy shaped branches.",
                               "Linear shaped branches originated in one point.",
                               "Curvy shaped branches originated in one point."))


## ----branching-tb-html, eval=knitr::is_html_output()--------------------------
# branch_tb |>
#   kable(caption = "cardinalR branching data generation functions", col.names = c("Function", "Explanation"), table.pos = "H")


## ----branching-tb-pdf, eval=knitr::is_latex_output()--------------------------
branch_tb |> 
  kable(caption = "cardinalR branching data generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## -----------------------------------------------------------------------------
arg_branching_tb <- tibble(arg = c("n",
                          "k"), 
                          type = c("integer", "integer"),
                        exp = c("Number of points.",
                                "Number of clusters."))


## ----arg-branching-tb-html, eval=knitr::is_html_output()----------------------
# arg_branching_tb |>
#   kable(caption = "The main arguments for branching shape generators.", col.names = c("Argument", "Type", "Explanation"), table.pos = "H")


## ----arg-branching-tb-pdf, eval=knitr::is_latex_output()----------------------
arg_branching_tb |> 
  kable(caption = "The main arguments for branching shape generators.", format="latex", col.names = c("Argument", "Type", "Explanation"), booktabs = T, table.pos = "H")  |>
  column_spec(1, width = "1cm") |>
  column_spec(1, width = "2cm") |>
  column_spec(2, width = "3cm")


## ----data-linearbranches, echo=TRUE-------------------------------------------
linearbranches <- gen_linearbranches(n = 1000, k = 4)


## ----data-curvybranches, echo=TRUE--------------------------------------------
curvybranches <- gen_curvybranches(n = 1000, k = 4)


## ----data-expbranches, echo=TRUE----------------------------------------------
expbranches <- gen_expbranches(n = 1000, k = 4)


## ----data-orglinearbranches, echo=TRUE----------------------------------------
orglinearbranches <- gen_orglinearbranches(n = 1000, p = 4, k = 4)


## -----------------------------------------------------------------------------
orglinearbranches_lang <- langevitour::langevitour(orglinearbranches, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----orglinearbranches-proj1--------------------------------------------------
scaled_data <- scale_data_manual(orglinearbranches)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.022))

orglinearbranches_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.7), 
  title = "d1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----orglinearbranches-proj2--------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

orglinearbranches_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.6), 
  title = "d2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----orglinearbranches-proj3--------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.4, 
                                              axis_pos_y = -0.4, 
                                              threshold = 0.016))

orglinearbranches_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.5, 0.62), 
  title = "d3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-orgcurvybranches, echo=TRUE-----------------------------------------
orgcurvybranches <- gen_orgcurvybranches(n = 1000, p = 4, k = 4)


## -----------------------------------------------------------------------------
orgcurvybranches_lang <- langevitour::langevitour(orgcurvybranches, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----orgcurvybranches-proj1---------------------------------------------------
scaled_data <- scale_data_manual(orgcurvybranches)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.3, 
                                              axis_pos_y = -0.3, 
                                              threshold = 0.022))

orgcurvybranches_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.4, 0.5), 
  title = "e1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----orgcurvybranches-proj2---------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

orgcurvybranches_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.6), 
  title = "e2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----orgcurvybranches-proj3---------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.4, 
                                              axis_pos_y = -0.4, 
                                              threshold = 0.016))

orgcurvybranches_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.5, 0.62), 
  title = "e3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----branch, eval=knitr::is_html_output(), fig.cap="`langevitour` output  of the `expbranches`, `linearbranches`, `curvybranches`, `orglinearbranches`, and `orgcurvybranches` data in $4\\text{-}D$."----
# 
# branchfig <- bscols(
#   htmltools::div(
#     style = "display: grid; grid-template-columns: 1fr 1fr;",
#     orglinearbranches_lang, orgcurvybranches_lang
#   ),
#   device = "xs"
# )
# 
# class(branchfig) <- c(class(branchfig), "htmlwidget")
# 
# branchfig


## ----branch-proj, eval=knitr::is_latex_output(), fig.cap="Three $2\\text{-}D$ projections from $4\\text{-}D$, for the `expbranches` (a1-a3), `linearbranches` (b1-b3), `curvybranches` (c1-c3), `orglinearbranches` (d1-d3), `orgcurvybranches` (e1-e3) data.", fig.width=12, fig.height=8----

orglinearbranches_proj1 + orglinearbranches_proj2 + orglinearbranches_proj3 +
orgcurvybranches_proj1 + orgcurvybranches_proj2 + orgcurvybranches_proj3 +
  plot_layout(ncol = 3, guides = "collect") 


## ----data-gridcube, echo=TRUE-------------------------------------------------
gridcube <- gen_gridcube(n = 1000, p = 4)


## ----data-unifcube, echo=TRUE-------------------------------------------------
unifcube <- gen_unifcube(n = 1000, p = 4)


## -----------------------------------------------------------------------------
cube_tb <- tibble(fun = c("gen_gridcube",
                          "gen_unifcube"), 
                      exp = c("Cube with specified grid points along each axes.",
                              "Cube with uniform points."))


## ----cube-tb-html, eval=knitr::is_html_output()-------------------------------
# cube_tb |>
#   kable(caption = "cardinalR cube data generation functions", col.names = c("Function", "Explanation"), table.pos = "H")


## ----cube-tb-pdf, eval=knitr::is_latex_output()-------------------------------
cube_tb |> 
  kable(caption = "cardinalR cube data generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## ----data-bluntedcone, echo=TRUE----------------------------------------------
cone <- gen_cone(n = 1000, p = 4, h = 5, ratio = 0.5)


## -----------------------------------------------------------------------------
cone_lang <- langevitour::langevitour(cone, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----cone-proj1---------------------------------------------------------------
scaled_data <- scale_data_manual(cone)

## First projection
projection <- cbind(
  c(0.22417,-0.02943,-0.02870,0.08418),
  c(-0.02715,0.18019,0.05053,0.15254))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.25,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.2, 
                                              axis_pos_y = -0.2, 
                                              threshold = 0.022))

cone_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.25, 0.25), 
  title = "a1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----cone-proj2---------------------------------------------------------------

## Second projection
projection <- cbind(
    c(0.15591,0.17907,0.03198,0.04496),
    c(-0.15376,0.10435,0.15766,0.00547))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.1,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.08, 
                                              axis_pos_y = -0.08, 
                                              threshold = 0.01))

cone_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.1, 0.12), 
  title = "a2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----cone-proj3---------------------------------------------------------------

## Third projection
projection <- cbind(
    c(-0.13548,0.13832,0.05991,-0.13544),
    c(0.08479,-0.10719,-0.01572,-0.20123))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.25,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.25, 
                                              axis_pos_y = -0.25, 
                                              threshold = 0.016))

cone_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.3, 0.2), 
  title = "a3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----cone, eval=knitr::is_html_output(), fig.cap="`langevitour` output  of the `cone` data in $4\\text{-}D$."----
# 
# conefig <- bscols(
#   htmltools::div(
#     style = "display: grid; grid-template-columns: 1fr 1fr;",
#     cone_lang
#   ),
#   device = "xs"
# )
# 
# class(conefig) <- c(class(conefig), "htmlwidget")
# 
# conefig


## ----cone-proj, eval=knitr::is_latex_output(), fig.cap="Three $2\\text{-}D$ projections from $4\\text{-}D$, for the `cone` data."----
#| fig-width: 12
#| fig-height: 4

cone_proj1 + cone_proj2 + cone_proj3 +
  plot_layout(ncol = 3, guides = "collect") 


## ----data-gau, echo=TRUE------------------------------------------------------
gau <- gen_gaussian(n = 1000, p = 4, s = diag(4))


## ----data-linear, echo=TRUE---------------------------------------------------
linear <- gen_longlinear(n = 1000, p = 4)


## ----data-mobius, echo=TRUE---------------------------------------------------
mobius <- gen_mobius(n = 1000)


## -----------------------------------------------------------------------------
polynomial_tb <- tibble(fun = c("gen_quadratic",
                                "gen_cubic"), 
                        exp = c("Quadratic pattern.",
                                "Cubic pattern."))


## ----polynomial-tb-html, eval=knitr::is_html_output()-------------------------
# polynomial_tb |>
#   kable(caption = "cardinalR polynomial data generation functions", col.names = c("Function", "Explanation"), table.pos = "H")


## ----polynomial-tb-pdf, eval=knitr::is_latex_output()-------------------------
polynomial_tb |> 
  kable(caption = "cardinalR polynomial data generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## ----data-quadratic, echo=TRUE------------------------------------------------
quadratic <- gen_quadratic(n = 1000)


## ----data-cubic, echo=TRUE----------------------------------------------------
cubic <- gen_cubic(n = 1000)


## ----data-pyrrect, echo=TRUE--------------------------------------------------
pyrrect <- gen_pyrrect(n = 1000, p = 4)


## -----------------------------------------------------------------------------
pyrrect_lang <- langevitour::langevitour(pyrrect, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----pyrrect-proj1------------------------------------------------------------
scaled_data <- scale_data_manual(pyrrect)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.022))

pyrrect_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.5), 
  title = "a1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrrect-proj2------------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.7, 
                                              axis_pos_x = -0.45, 
                                              axis_pos_y = -0.45, 
                                              threshold = 0.08))

pyrrect_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.6, 0.6), 
  title = "a2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrrect-proj3------------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.4, 
                                              axis_pos_y = -0.4, 
                                              threshold = 0.016))

pyrrect_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.5, 0.75), 
  title = "a3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-pyrtri, echo=TRUE---------------------------------------------------
pyrtri <- gen_pyrtri(n = 1000, p = 4)


## -----------------------------------------------------------------------------
pyrtri_lang <- langevitour::langevitour(pyrtri, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----pyrtri-proj1-------------------------------------------------------------
scaled_data <- scale_data_manual(pyrtri)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.3,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.2, 
                                              axis_pos_y = -0.2, 
                                              threshold = 0.022))

pyrtri_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.25, 0.3), 
  title = "b1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrtri-proj2-------------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.3,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.25, 
                                              axis_pos_y = -0.25, 
                                              threshold = 0.03))

pyrtri_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.3, 0.4), 
  title = "b2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrtri-proj3-------------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.4, 
                                              axis_pos_y = -0.4, 
                                              threshold = 0.016))

pyrtri_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.5, 0.62), 
  title = "b3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-pyrstar, echo=TRUE--------------------------------------------------
pyrstar <- gen_pyrstar(n = 1000, p = 4)


## -----------------------------------------------------------------------------
pyrstar_lang <- langevitour::langevitour(pyrstar, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----pyrstar-proj1------------------------------------------------------------
scaled_data <- scale_data_manual(pyrstar)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.022))

pyrstar_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.5), 
  title = "c1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrstar-proj2------------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

pyrstar_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.4), 
  title = "c2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrstar-proj3------------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.016))

pyrstar_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.62), 
  title = "c3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-pyrholes, echo=TRUE-------------------------------------------------
pyrholes <- gen_pyrfrac(n = 1000, p = 4)


## -----------------------------------------------------------------------------
pyrholes_lang <- langevitour::langevitour(pyrholes, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----pyrholes-proj1-----------------------------------------------------------
scaled_data <- scale_data_manual(pyrholes)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.022))

pyrholes_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.7), 
  title = "d1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrholes-proj2-----------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

pyrholes_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.75), 
  title = "d2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----pyrholes-proj3-----------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.016))

pyrholes_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.62), 
  title = "d3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## -----------------------------------------------------------------------------
pyramid_tb <- tibble(fun = c("gen_pyrrect",
                             "gen_pyrtri",
                             "gen_pyrstar",
                             "gen_pyrfrac"), 
                        exp = c("Rectangular-base, with a sharp or blunted apex.",
          "Triangular-base, with a sharp or blunted apex.",
          "Star-shaped base, with a sharp or blunted apex.",
          "Pyramid with triangular pyramid-shaped holes."))


## ----pyramid-tb-html, eval=knitr::is_html_output()----------------------------
# pyramid_tb |>
#   kable(caption = "cardinalR pyramid data generation functions", col.names = c("Function", "Explanation"), table.pos = "H")


## ----pyramid-tb-pdf, eval=knitr::is_latex_output()----------------------------
pyramid_tb |> 
  kable(caption = "cardinalR pyramid data generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## ----pyr, eval=knitr::is_html_output(), fig.cap="`langevitour` output  of the `pyrrect`, `pyrtri`, `pyrstar`, and `pyrholes` data in $4\\text{-}D$."----
# 
# pyrfig <- bscols(
#   htmltools::div(
#     style = "display: grid; grid-template-columns: 1fr 1fr;",
#     pyrrect_lang, pyrtri_lang, pyrstar_lang, pyrholes_lang
#   ),
#   device = "xs"
# )
# 
# class(pyrfig) <- c(class(pyrfig), "htmlwidget")
# 
# pyrfig


## ----pyr-proj, eval=knitr::is_latex_output(), fig.cap="Three $2\\text{-}D$ projections from $4\\text{-}D$, for the `pyrrect` (a1-a3), `pyrtri` (b1-b3), `pyrstar` (c1-c3), and `pyrholes` (d1-d3) data.", fig.width=12, fig.height=16----

pyrrect_proj1 + pyrrect_proj2 + pyrrect_proj3 +
pyrtri_proj1 + pyrtri_proj2 + pyrtri_proj3 +
pyrstar_proj1 + pyrstar_proj2 + pyrstar_proj3 +
pyrholes_proj1 + pyrholes_proj2 + pyrholes_proj3 +
  plot_layout(ncol = 3, guides = "collect") 


## ----data-scurve, echo=TRUE---------------------------------------------------
scurve <- gen_scurve(n = 1000)


## -----------------------------------------------------------------------------
sphere_tb <- tibble(fun = c("gen_circle",
                            "gen_curvycycle",
                            "gen_unifsphere",
                            "gen_gridedsphere",
                            "gen_clusteredspheres",
                            "gen_hemisphere"), 
                        exp = c("Circle.",
                                "Curvy cell cycle.",
                                "Uniform sphere.",
                                "Grided sphere.",
                                "Multiple small spheres within a big sphere.",
                                "Hemisphere."))


## ----sphere-tb-html, eval=knitr::is_html_output()-----------------------------
# sphere_tb |>
#   kable(caption = "cardinalR sphere data generation functions", col.names = c("Function", "Explanation"), linesep = "", table.pos = "H")


## ----sphere-tb-pdf, eval=knitr::is_latex_output()-----------------------------
sphere_tb |> 
  kable(caption = "cardinalR sphere data generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, linesep = "", table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## ----data-circle, echo=TRUE---------------------------------------------------
circle <- gen_circle(n = 1000, p = 4)


## -----------------------------------------------------------------------------
circle_lang <- langevitour::langevitour(circle, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----circle-proj1-------------------------------------------------------------
scaled_data <- scale_data_manual(circle)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

circle_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.8), 
  title = "a1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----circle-proj2-------------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

circle_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.7), 
  title = "a2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----circle-proj3-------------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.016))

circle_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.6, 0.53), 
  title = "a3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-curvycycle, echo=TRUE-----------------------------------------------
curvycycle <- gen_curvycycle(n = 1000, p = 4)


## -----------------------------------------------------------------------------
curvycycle_lang <- langevitour::langevitour(curvycycle, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----curvycycle-proj1---------------------------------------------------------
scaled_data <- scale_data_manual(curvycycle)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

curvycycle_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.7), 
  title = "b1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----curvycycle-proj2---------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.04))

curvycycle_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.6), 
  title = "b2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----curvycycle-proj3---------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.016))

curvycycle_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.62), 
  title = "b3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-unifsphere, echo=TRUE-----------------------------------------------
unifsphere <- gen_unifsphere(n = 1000, r = 1)


## -----------------------------------------------------------------------------
unifsphere_lang <- langevitour::langevitour(unifsphere, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----unifsphere-proj1---------------------------------------------------------
scaled_data <- scale_data_manual(unifsphere)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097),
  c(0.00896,0.52496,0.12597))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

unifsphere_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.7), 
  title = "c1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----unifsphere-proj2---------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278),
  c(-0.50493,0.14388,0.14615))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

unifsphere_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.7), 
  title = "c2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----unifsphere-proj3---------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416),
  c(0.50329,0.07199,-0.16064))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.016))

unifsphere_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.65), 
  title = "c3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-hollowsphere, echo=TRUE---------------------------------------------
hollowsphere <- gen_hollowsphere(n = 1000, p = 4)


## ----data-gridedsphere, echo=TRUE---------------------------------------------
gridedsphere <- gen_gridedsphere(n = 1000, p = 4)


## -----------------------------------------------------------------------------
gridedsphere_lang <- langevitour::langevitour(gridedsphere, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----gridedsphere-proj1-------------------------------------------------------
scaled_data <- scale_data_manual(gridedsphere)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

gridedsphere_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.7), 
  title = "d1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----gridedsphere-proj2-------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

gridedsphere_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.65), 
  title = "d2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----gridedsphere-proj3-------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.016))

gridedsphere_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.62), 
  title = "d3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-clusteredspheres, echo=TRUE-----------------------------------------
clusteredspheres <- gen_clusteredspheres(n = c(1000, 100), k = 3, r = c(15, 3),
                                         loc = 10 / sqrt(3)) |>
  dplyr::select(-cluster)


## -----------------------------------------------------------------------------
clusteredspheres_lang <- langevitour::langevitour(clusteredspheres, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----clusteredspheres-proj1---------------------------------------------------
scaled_data <- scale_data_manual(clusteredspheres)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097),
  c(0.00896,0.52496,0.12597))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

clusteredspheres_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.7), 
  title = "e1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----clusteredspheres-proj2---------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278),
  c(-0.50493,0.14388,0.14615))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

clusteredspheres_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.6), 
  title = "e2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----clusteredspheres-proj3---------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416),
  c(0.50329,0.07199,-0.16064))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.016))

clusteredspheres_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.6, 0.62), 
  title = "e3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-hemisphere, echo=TRUE-----------------------------------------------
hemisphere <- gen_hemisphere(n = 1000)


## -----------------------------------------------------------------------------
hemisphere_lang <- langevitour::langevitour(hemisphere, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----hemisphere-proj1---------------------------------------------------------
scaled_data <- scale_data_manual(hemisphere)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

hemisphere_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.7), 
  title = "f1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----hemisphere-proj2---------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

hemisphere_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.6), 
  title = "f2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----hemisphere-proj3---------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.016))

hemisphere_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.62), 
  title = "f3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----sphere, eval=knitr::is_html_output(), fig.cap="`langevitour` output  of the `circle`, `curvycycle`, `unifsphere`, `gridedsphere`, `clusteredspheres`, and `hemisphere` data in $4\\text{-}D$."----
# 
# spherefig <- bscols(
#   htmltools::div(
#     style = "display: grid; grid-template-columns: 1fr 1fr;",
#     circle_lang, curvycycle_lang, unifsphere_lang, gridedsphere_lang, clusteredspheres_lang, hemisphere_lang
#   ),
#   device = "xs"
# )
# 
# class(spherefig) <- c(class(spherefig), "htmlwidget")
# 
# spherefig


## ----sphere-proj, eval=knitr::is_latex_output(), fig.cap="Three $2\\text{-}D$ projections from $4\\text{-}D$, for the `circle` (a1-a3), `curvycycle` (b1-b3), `unifsphere` (c1-c3), `gridedsphere` (d1-d3), `clusteredspheres` (e1-e3), and `hemisphere` (f1-f3) data.", fig.width=12, fig.height=28, out.width="80%", fig.align='center'----

circle_proj1 + circle_proj2 + circle_proj3 +
curvycycle_proj1 + curvycycle_proj2 + curvycycle_proj3 +
unifsphere_proj1 + unifsphere_proj2 + unifsphere_proj3 +
gridedsphere_proj1 + gridedsphere_proj2 + gridedsphere_proj3 +
clusteredspheres_proj1 + clusteredspheres_proj2 + clusteredspheres_proj3 +
hemisphere_proj1 + hemisphere_proj2 + hemisphere_proj3 +
  plot_layout(ncol = 3, guides = "collect") 


## ----data-swissroll, echo=TRUE------------------------------------------------
swissroll <- gen_swissroll(n = 1000, w = c(-1, 1))


## -----------------------------------------------------------------------------
trefoil_tb <- tibble(fun = c("gen_trefoil4d",
                            "gen_trefoil3d"), 
                        exp = c("Trefoil in 4-D.",
                                "Trefoil in 3-D."))


## ----trefoil-tb-html, eval=knitr::is_html_output()----------------------------
# trefoil_tb |>
#   kable(caption = "cardinalR trefoil data generation functions", col.names = c("Function", "Explanation"), table.pos = "H")


## ----trefoil-tb-pdf, eval=knitr::is_latex_output()----------------------------

trefoil_tb |> 
  kable(caption = "cardinalR trefoil data generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## ----data-trefoil4d, echo=TRUE------------------------------------------------
trefoil4d <- gen_trefoil4d(n = 500, steps = 5)


## -----------------------------------------------------------------------------
trefoil4d_lang <- langevitour::langevitour(trefoil4d, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----trefoil4d-proj1----------------------------------------------------------
scaled_data <- scale_data_manual(trefoil4d)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

trefoil4d_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.7), 
  title = "a1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----trefoil4d-proj2----------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

trefoil4d_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.65), 
  title = "a2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----trefoil4d-proj3----------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.55, 
                                              axis_pos_y = -0.55, 
                                              threshold = 0.016))

trefoil4d_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.62), 
  title = "a3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-trefoil3d, echo=TRUE------------------------------------------------
trefoil3d <- gen_trefoil3d(n = 500, steps = 5)


## -----------------------------------------------------------------------------
trefoil3d_lang <- langevitour::langevitour(trefoil3d, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----trefoil3d-proj1----------------------------------------------------------
scaled_data <- scale_data_manual(trefoil3d)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097),
  c(0.00896,0.52496,0.12597))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.6, 
                                              axis_pos_y = -0.6, 
                                              threshold = 0.022))

trefoil3d_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.75, 0.7), 
  title = "b1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----trefoil3d-proj2----------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278),
  c(-0.50493,0.14388,0.14615))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

trefoil3d_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.65), 
  title = "b2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----trefoil3d-proj3----------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416),
  c(0.50329,0.07199,-0.16064))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.55, 
                                              axis_pos_y = -0.55, 
                                              threshold = 0.016))

trefoil3d_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.62), 
  title = "b3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----trefoil, eval=knitr::is_html_output(), fig.cap="`langevitour` output  of the `trefoil4d` and `trefoil3d` data in $4\\text{-}D$."----
# 
# trefoilfig <- bscols(
#   htmltools::div(
#     style = "display: grid; grid-template-columns: 1fr 1fr;",
#     trefoil4d_lang, trefoil3d_lang
#   ),
#   device = "xs"
# )
# 
# class(trefoilfig) <- c(class(trefoilfig), "htmlwidget")
# 
# trefoilfig


## ----trefoil-proj, eval=knitr::is_latex_output(), fig.cap="Three $2\\text{-}D$ projections from $4\\text{-}D$, for the `trefoil4d` (a1-a3) and `trefoil3d` (b1-b3) data.", fig.width=12, fig.height=8----

trefoil4d_proj1 + trefoil4d_proj2 + trefoil4d_proj3 + 
  trefoil3d_proj1 + trefoil3d_proj2 + trefoil3d_proj3 +
  plot_layout(ncol = 3, guides = "collect") 


## -----------------------------------------------------------------------------
trigonometric_tb <- tibble(fun = c("gen_crescent",
                            "gen_curvycylinder",
                            "gen_sphericalspiral",
                            "gen_helicalspiral",
                            "gen_conicspiral",
                            "gen_nonlinear"), 
                        exp = c("Crescent pattern.",
                                "Curvy cylinder.",
                                "Spherical spiral.",
                                "Helical spiral.",
                                "Conic spiral.",
                                "Nonlinear hyperbola."))


## ----trigonometric-tb-html, eval=knitr::is_html_output()----------------------
# trigonometric_tb |>
#   kable(caption = "cardinalR trigonometric data generation functions", col.names = c("Function", "Explanation"), linesep = "", table.pos = "H")


## ----trigonometric-tb-pdf, eval=knitr::is_latex_output()----------------------
trigonometric_tb |> 
  kable(caption = "cardinalR trigonometric data generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, linesep = "", table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## ----data-crescent, echo=TRUE-------------------------------------------------
crescent <- gen_crescent(n = 1000)


## ----data-curvycylinder, echo=TRUE--------------------------------------------
curvycylinder <- gen_curvycylinder(n = 1000, h = 10)


## -----------------------------------------------------------------------------
curvycylinder_lang <- langevitour::langevitour(curvycylinder, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----curvycylinder-proj1------------------------------------------------------
scaled_data <- scale_data_manual(curvycylinder)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.022))

curvycylinder_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.5), 
  title = "b1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----curvycylinder-proj2------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

curvycylinder_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.6), 
  title = "b2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----curvycylinder-proj3------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.4, 
                                              axis_pos_y = -0.4, 
                                              threshold = 0.016))

curvycylinder_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.5, 0.5), 
  title = "b3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-sphericalspiral, echo=TRUE------------------------------------------
sphericalspiral <- gen_sphericalspiral(n = 1000, spins = 1)


## -----------------------------------------------------------------------------
sphericalspiral_lang <- langevitour::langevitour(sphericalspiral, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----sphericalspiral-proj1----------------------------------------------------
scaled_data <- scale_data_manual(sphericalspiral)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.022))

sphericalspiral_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.7), 
  title = "c1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----sphericalspiral-proj2----------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.57, 
                                              axis_pos_y = -0.57, 
                                              threshold = 0.01))

sphericalspiral_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.7, 0.6), 
  title = "c2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----sphericalspiral-proj3----------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.4, 
                                              axis_pos_y = -0.4, 
                                              threshold = 0.016))

sphericalspiral_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.5, 0.5), 
  title = "c3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-helicalspiral, echo=TRUE--------------------------------------------
helicalspiral <- gen_helicalspiral(n = 1000)


## ----data-conicspiral, echo=TRUE----------------------------------------------
conicspiral <- gen_conicspiral(n = 1000, spins = 1)


## -----------------------------------------------------------------------------
conicspiral_lang <- langevitour::langevitour(conicspiral, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----conicspiral-proj1--------------------------------------------------------
scaled_data <- scale_data_manual(conicspiral)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.5, 
                                              axis_pos_y = -0.5, 
                                              threshold = 0.022))

conicspiral_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.65, 0.7), 
  title = "e1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----conicspiral-proj2--------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 3, 
                                              axis_pos_x = -0.65, 
                                              axis_pos_y = -0.65, 
                                              threshold = 0.01))

conicspiral_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.8, 0.5), 
  title = "e2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----conicspiral-proj3--------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.6,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.45, 
                                              axis_pos_y = -0.45, 
                                              threshold = 0.016))

conicspiral_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.6, 0.62), 
  title = "e3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----data-nonlinear, echo=TRUE------------------------------------------------
nonlinear <- gen_nonlinear(n = 1000, hc = 1, non_fac = 0.5)


## -----------------------------------------------------------------------------
nonlinear_lang <- langevitour::langevitour(nonlinear, levelColors = "black", enableControls = FALSE, width = "400px", height = "300px")


## ----nonlinear-proj1----------------------------------------------------------
scaled_data <- scale_data_manual(nonlinear)

## First projection
projection <- cbind(
  c(0.53506,0.00763,0.00097,-0.10901),
  c(0.00896,0.52496,0.12597,0.08184))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.7,
                                              axis_scaled = 1.2, 
                                              axis_pos_x = -0.3, 
                                              axis_pos_y = -0.3, 
                                              threshold = 0.022))

nonlinear_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.45, 0.73), 
  title = "f1", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----nonlinear-proj2----------------------------------------------------------

## Second projection
projection <- cbind(
  c(-0.06614,0.15134,-0.44278,0.27367),
  c(-0.50493,0.14388,0.14615,0.03486))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.45,
                                              axis_scaled = 1.3, 
                                              axis_pos_x = -0.2, 
                                              axis_pos_y = -0.2, 
                                              threshold = 0.01))

nonlinear_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.3, 0.46), 
  title = "f2", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----nonlinear-proj3----------------------------------------------------------

## Third projection
projection <- cbind(
  c(0.10704,0.04822,-0.03416,0.53224),
  c(0.50329,0.07199,-0.16064,-0.11806))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.2, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 0.45,
                                              axis_scaled = 1.5, 
                                              axis_pos_x = -0.25, 
                                              axis_pos_y = -0.25, 
                                              threshold = 0.016))

nonlinear_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2, "#000000"), # size, alpha, color
  plot_limits = c(-0.35, 0.4), 
  title = "f3", 
  cex = 2, 
  axis_text_size = 5,
  is_color = FALSE)



## ----triginometric, eval=knitr::is_html_output(), fig.cap="`langevitour` output  of tthe `crescent`, `curvycylinder`, `sphericalspiral`, `helicalspiral`, `conicspiral`, and `nonlinear` data in $4\\text{-}D$."----
# 
# triginometricfig <- bscols(
#   htmltools::div(
#     style = "display: grid; grid-template-columns: 1fr 1fr;",
#     curvycylinder_lang, sphericalspiral_lang, conicspiral_lang, nonlinear_lang
#   ),
#   device = "xs"
# )
# 
# class(triginometricfig) <- c(class(triginometricfig), "htmlwidget")
# 
# triginometricfig


## ----triginometric-proj, eval=knitr::is_latex_output(), fig.cap="Three $2\\text{-}D$ projections from $4\\text{-}D$, for the `crescent` (a1-a3), `curvycylinder` (b1-b3), `sphericalspiral` (c1-c3), `helicalspiral` (d1-d3), `conicspiral` (e1-e3), and `nonlinear` (f1-f3) data.", fig.width=12, fig.height=16, out.width="80%", fig.align='center'----

curvycylinder_proj1 + curvycylinder_proj2 + curvycylinder_proj3 +
sphericalspiral_proj1 + sphericalspiral_proj2 + sphericalspiral_proj3 +
conicspiral_proj1 + conicspiral_proj2 + conicspiral_proj3 +
nonlinear_proj1 + nonlinear_proj2 + nonlinear_proj3 +
  plot_layout(ncol = 3, guides = "collect") 


## -----------------------------------------------------------------------------
noise_fun_tb <- tibble(fun = c("gen_noisedims",
                            "gen_wavydims1",
                            "gen_wavydims2",
                            "gen_wavydims3"), 
                        exp = c("Gaussian noise dimensions with optional mean and standard deviation.",
                                "Wavy noise dimensions based on a user-specified theta sequence with added jitter.",
                                "Wavy noise dimensions using polynomial transformations of an existing dimension vector.",
                                "Wavy noise dimensions using a combination of polynomial and sine transformations based on the first three dimensions of a dataset."))


## ----noise-tb-html, eval=knitr::is_html_output()------------------------------
# noise_fun_tb |>
#   kable(caption = "cardinalR noise dimensions generation functions", col.names = c("Function", "Explanation"), table.pos = "H")


## ----noise-tb-pdf, eval=knitr::is_latex_output()------------------------------
noise_fun_tb |> 
  kable(caption = "cardinalR noise dimensions generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, table.pos = "H")  |>
  column_spec(1, width = "3cm") |>
  column_spec(2, width = "9cm")


## -----------------------------------------------------------------------------
odd_shapes_tb <- tibble(fun = c("make_mobiusgau",
                                "make_multigau",
                                "make_curvygau",
                                "make_klink_circles",
                                "make_chain_circles",
                                "make_klink_curvycycle",
                                "make_chain_curvycycle",
                                "make_gaucircles",
                                "make_gaucurvycycle",
                                "make_onegrid",
                                "make_twogrid_overlap",
                                "make_twogrid_shift",
                                "make_shape_para",
                                "make_three_clust_"), 
                        exp = c(
    "Mbius-like cluster combined with a Gaussian.",
    "Multiple Gaussian clusters in high-dimensional space.",
    "Curvilinear cluster with a Gaussian cluster.",
    "K-link circular clusters (non-linear circular patterns).",
    "Chain-like circular clusters connected sequentially.",
    "K-link curvy cycle clusters (curvilinear loop structures).",
    "Chain-like curvy cycle clusters connected sequentially.",
    "Circular clusters with a Gaussian cluster in the middle.",
    "Curvy circular clusters with a Gaussian in the middle.",
    "Single grid in two dimensions.",
    "Two overlapping grids.",
    "Two grids shifted relative to each other.",
    "Parallel shaped clusters.",
    "Three clusters with different shapes. (eg:- 01, 02, ..., 20)"))


## ----odd-shape-tb-html, eval=knitr::is_html_output()--------------------------
# odd_shapes_tb |>
#   kable(caption = "cardinalR multiple clusters generation functions", col.names = c("Function", "Explanation"), linesep = "", table.pos = "H")


## ----odd-shape-tb-pdf, eval=knitr::is_latex_output()--------------------------
odd_shapes_tb |> 
  kable(caption = "cardinalR multiple clusters generation functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, linesep = "", table.pos = "H")  |>
  column_spec(1, width = "3.5cm") |>
  column_spec(2, width = "8.5cm")


## -----------------------------------------------------------------------------
add_fun_tb <- tibble(fun = c("gen_bkgnoise",
                            "randomize_rows",
                            "relocate_clusters",
                            "gen_nproduct",
                            "gen_nsum",
                            "gen_rotation",
                            "normalize_data"), 
                        exp = c("Adds background noise.",
                                "Randomizes the rows.",
                                "Relocates the clusters.",
                                "Generates a vector of positive integers whose product is approximately equal to a target value.",
                                "Generates a vector of positive integers whose summation is approximately equal to a target value.", 
                                "Generates rotations.", 
                                "Normalizes data."))


## ----add-tb-html, eval=knitr::is_html_output()--------------------------------
# add_fun_tb |>
#   kable(caption = "cardinalR additional functions", col.names = c("Function", "Explanation"), linesep = "", table.pos = "H")


## ----add-tb-pdf, eval=knitr::is_latex_output()--------------------------------
add_fun_tb |> 
  kable(caption = "cardinalR additional functions", format="latex", col.names = c("Function", "Explanation"), booktabs = T, linesep = "", table.pos = "H")  |>
  column_spec(1, width = "4cm") |>
  column_spec(2, width = "8cm")


## ----gen-five-clust-data, echo=TRUE-------------------------------------------

positions <- geozoo::simplex(p=4)$points
positions <- positions * 0.8

## To generate data
five_clusts <- gen_multicluster(n = c(2250, 1500, 750, 1250, 1750), k = 5,
                       loc = positions,
                       scale = c(0.4, 0.35, 0.3, 1, 0.3),
                       shape = c("helicalspiral", "hemisphere", "unifcube", 
                                 "cone", "gaussian"),
                       rotation = NULL,
                       is_bkg = FALSE)


## ----highd-data, eval=knitr::is_html_output(), fig.cap="`langevitour` output showing five synthetic clusters with distinct geometric structures: a helical spiral, a hemisphere, a uniform cube, a cone, and a Gaussian cluster."----
# 
# langevitour::langevitour(five_clusts[, -5], group = five_clusts$cluster, levelColors = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e'))


## ----five-clusts-projections1-------------------------------------------------
scaled_data <- scale_data_manual(five_clusts[, -5])

## First projection
projection <- cbind(
  c(-0.59692,0.46414,0.42436,-0.10048),
  c(-0.54999,-0.67673,-0.03631,-0.01193))

proj_obj1 <- get_projection(projection = projection, 
                            proj_scale = 1.23, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 1,
                                              axis_scaled = 0.8, 
                                              axis_pos_x = -0.9, 
                                              axis_pos_y = -0.9, 
                                              threshold = 0.05))

proj_obj1[["cluster"]] <- as.character(five_clusts$cluster)

five_clusts_proj1 <- plot_proj(
  proj_obj = proj_obj1, 
  point_param = c(1.5, 0.2), # size, alpha, color
  plot_limits = c(-1.1, 1), 
  title = "a1", 
  cex = 2, 
  axis_text_size = 4,
  is_color = TRUE) + scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(legend.text = element_text(size = 10))



## ----five-clusts-projections2-------------------------------------------------
## Second projection
projection <- cbind(
  c(0.34673,-0.35774,0.66272,0.27298),
  c(0.24023,0.01170,-0.41886,0.72707))

proj_obj2 <- get_projection(projection = projection, 
                            proj_scale = 1.23, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 1,
                                              axis_scaled = 0.8, 
                                              axis_pos_x = -0.9, 
                                              axis_pos_y = -0.9, 
                                              threshold = 0.07))

proj_obj2[["cluster"]] <- as.character(five_clusts$cluster)

five_clusts_proj2 <- plot_proj(
  proj_obj = proj_obj2, 
  point_param = c(1.5, 0.2), # size, alpha, color
  plot_limits = c(-1.1, 1.2), 
  title = "a2", 
  cex = 2, 
  axis_text_size = 4,
  is_color = TRUE) + scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(legend.text = element_text(size = 10))


## ----five-clusts-projections3-------------------------------------------------
## Third projection
projection <- cbind(
  c(0.47388,-0.20984,-0.56560,0.41644),
  c(-0.51124,-0.60184,0.06463,0.36627))

proj_obj3 <- get_projection(projection = projection, 
                            proj_scale = 1.23, 
                            scaled_data = scaled_data, 
                            axis_param = list(limits = 1,
                                              axis_scaled = 0.8, 
                                              axis_pos_x = -0.9, 
                                              axis_pos_y = -0.9, 
                                              threshold = 0.05))

proj_obj3[["cluster"]] <- as.character(five_clusts$cluster)

five_clusts_proj3 <- plot_proj(
  proj_obj = proj_obj3, 
  point_param = c(1.5, 0.2), # size, alpha, color
  plot_limits = c(-1.1, 1.1), 
  title = "a3", 
  cex = 2, 
  axis_text_size = 4,
  is_color = TRUE) + scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(legend.text = element_text(size = 10))



## ----highd-proj, eval=knitr::is_latex_output(), fig.pos='H', fig.cap="Three $2\\text{-}D$ projections from $4\\text{-}D$, for the five clusters data. The helical spiral cluster is represented in dark green, the hemisphere cluster in orange, the uniform cube-shaped cluster in purple, the blunted cone cluster in pink, and the Gaussian-shaped cluster in light green."----
#| fig-width: 12
#| fig-height: 4

five_clusts_proj1 + five_clusts_proj2 + five_clusts_proj3 +
  plot_layout(ncol = 3, guides = "collect") 


## ----layouts------------------------------------------------------------------

tsne_data <- read_rds("data/five_clusts/five_clusts_tsne_perplexity_30.rds") 

nldr1 <- tsne_data |>
  ggplot(aes(x = tSNE1,
             y = tSNE2,
             color = cluster))+
  geom_point(alpha=0.1, size=1) +
  interior_annotation("a", c(0.08, 0.93)) + 
  scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(aspect.ratio = 1,
        legend.text = element_text(size = 10)) 

umap_data <- read_rds("data/five_clusts/five_clusts_umap_n-neigbors_15_min-dist_0.1.rds") 

nldr2 <- umap_data |>
  ggplot(aes(x = UMAP1,
             y = UMAP2,
             color = cluster))+
  geom_point(alpha=0.1, size=1) +
  interior_annotation("b", c(0.08, 0.93)) + 
  scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(aspect.ratio = 1,
        legend.text = element_text(size = 10)) 

phate_data <- read_rds("data/five_clusts/five_clusts_phate_knn_5.rds") 

nldr3 <- phate_data |>
  ggplot(aes(x = PHATE1,
             y = PHATE2,
             color = cluster))+
  geom_point(alpha=0.1, size=1) +
  interior_annotation("c", c(0.08, 0.93)) + 
  scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(aspect.ratio = 1,
        legend.text = element_text(size = 10)) 

trimap_data <- read_rds("data/five_clusts/five_clusts_trimap_n-inliers_12_n-outliers_4_n-random_3.rds") 

nldr4 <- trimap_data |>
  ggplot(aes(x = TriMAP1,
             y = TriMAP2,
             color = cluster))+
  geom_point(alpha=0.1, size=1) +
  interior_annotation("d", c(0.08, 0.93)) + 
  scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(aspect.ratio = 1,
        legend.text = element_text(size = 10))  

pacmap_data <- read_rds("data/five_clusts/five_clusts_pacmap_n-neighbors_10_init_random_MN-ratio_0.5_FP-ratio_2.rds") 

nldr5 <- pacmap_data |>
  ggplot(aes(x = PaCMAP1,
             y = PaCMAP2,
             color = cluster))+
  geom_point(alpha=0.1, size=1) +
  interior_annotation("e", c(0.08, 0.93)) + 
  scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(aspect.ratio = 1,
        legend.text = element_text(size = 10)) 

pca_data <- read_rds("data/five_clusts/five_clusts_pca.rds") 

nldr6 <- pca_data |>
  ggplot(aes(x = pca1,
             y = pca2,
             color = cluster))+
  geom_point(alpha=0.1, size=1) +
  interior_annotation("f", c(0.08, 0.93)) + 
  scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e')) +
  theme(aspect.ratio = 1,
        legend.text = element_text(size = 10)) 


## ----label = "fig-nldr-layouts", fig.pos="H", fig.cap="Six different dimension reduction representations of the five clusters data using default hyperparameter settings: (a) tSNE, (b) UMAP, (c) PAHTE, (d) TriMAP, (e) PaCMAP, and (f) PCA."----

nldr1 + nldr2 + nldr3 +
  nldr4 + nldr5 + nldr6 +
  plot_layout(ncol = 3, guides = "collect")

